var parisLatitude = 48.864716;
var parisLongitude =  2.349014 ;
var map ;

<% event_today = Event.all %>
getMapAsync();



function initMapWithoutGeolocation()
{
   map = L.map('main-map').setView([parisLatitude,parisLongitude],15);
   L.tileLayer('https://{s}.tile.openstreetmap.se/hydda/full/{z}/{x}/{y}.png',{maxZoom :100}).addTo(map);
   createMapCircles()
}

function initMapWithGeolocation(lat,lng)
{
   map = L.map('main-map').setView([lat,lng],15);
   L.tileLayer('https://{s}.tile.openstreetmap.se/hydda/full/{z}/{x}/{y}.png',{maxZoom :100}).addTo(map);
   createMapCircles()
}

if (!navigator.geolocation)
{
    initMapWithoutLocation();
}
function success(position)
{
    userLatitude = position.coords.latitude;
    userLongitude = position.coords.longitude;
    initMapWithGeolocation(userLatitude,userLongitude);
}
function failure()
{
  initMapWithoutGeolocation();
}

function getMapAsync()
{
    setTimeout(function() {navigator.geolocation.getCurrentPosition(success,failure)},1);
    return map;

}
